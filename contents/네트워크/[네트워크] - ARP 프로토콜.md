# [네트워크] - ARP 프로토콜

ARP 프로토콜은 같은 네트워크 대역에서 통신을 하기 위해 필요한 MAC 주소를 IP 주소를 이용해서 알아오는 프로토콜이다.

같은 네트워크 대역에서 통신을 한다고 하더라도 데이터를 보내기 위해서는 7계층부터 캡슐화를 통해 데이터를 보내기 때문에 IP 주소와 MAC 주소가 모두 필요하다. 이때 IP 주소는 알고 MAC 주소는 모르더라도 ARP를 통해 통신이 가능하다. 

<BR>

### - ARP 프로토콜의 구조

![image-20230117182250633](%5B%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%5D%20-%20ARP%20%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C.assets/image-20230117182250633.png)

- 한줄이 4바이트, 총 28바이트
- 위에 빨간색 6바이트 : 출발지MAC 주소, 바로 밑에 파란색 4바이트 : 출발지 IP 주소
- 그 밑에 빨간색 6바이트 : 목적지 MAC 주소, 밑에 파란색 4바이트 : 목적지 IP 주소

- 제일 위에 Hardware type은 대부분 이더넷, Protocol type은 대부분 IPv4



<BR>

### - ARP 프로토콜의 통신

**1.** 송신자는 목적지 IP Address를 지정해 패킷을 송신

**2.** IP 프로토콜이 ARP 프로토콜에게 ARP Request 메시지를 생성하도록 요청

**3.** 메시지는 데이터링크 계층으로 전달되고 이더넷 프레임으로 Encapsulation됨

**4.** 모든 호스트와 라우터는 프레임을 수신 후 자신의 ARP 프로토콜에게 전달

**5.** 목적지 IP Address가 일치하는 시스템은 자신의 물리주소를 포함하고 있는 ARP Reply 메시지를 보냄

**6.** 최초 송신 측은 지정한 IP Address에 대응하는 물리주소를 획득

[동작 과정 그림으로 보기](https://coding-factory.tistory.com/720)