# [네트워크] - NAT와 포트포워딩



### - NAT 란?

Network Address Translation은 IP 패킷의 TCP/UDP 포트 숫자와 소스 및 목적지의 IP 주소 등을 재기록하면서 라우터를 통해 네트워크 트래픽을 주고 받는 기술을 말한다.

패킷에 변화가 생기기 때문에 IP나 TCP/UDP의 체크섬(checksum)도 다시 계산되어 재기록해야 한다.

NAT를 이용하는 이유는 대개 사설 네트워크에 속한 여러 개의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위함이다. 

하지만 꼭 사설 IP를 공인 IP로 변환 하는 데에만 사용하는 기술은 아니다. 

<BR>

 ![image-20230130172332663](%5B%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%5D%20-%20NAT%EC%99%80%20%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20230130172332663.png)

- 사설 IP 대역의 PC들이 공유기에 할당되어 있는 공인 IP로 통신을 한다.

![image-20230130172453031](%5B%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%5D%20-%20NAT%EC%99%80%20%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20230130172453031.png)

- 그래서 공유기 끼리 통신하는 것처럼 보지만 내부적으로는 아님

<BR>

###  - 포트포워딩

포트 매핑(port mapping)은 패킷이 라우터나 방화벽과 같은 네트워크 장비를 가로지르는 동안 **<u>특정 IP 주소와 포트 번호의 통신 요청을 특정 다른 IP와 포트 번호로 넘겨주는</u>** 네트워크 주소 변환(NAT)의 응용이다.

이 기법은 게이트웨이(외부망)의 반대쪽에 위치한 사설네트워크에 상주하는 호스트에 대한 서비스를 생성하기 위해 흔히 사용한다. 

![image-20230130172802950](%5B%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%5D%20-%20NAT%EC%99%80%20%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20230130172802950.png)

- 공인 IP를 통해 공유기에 패킷이 전달되고 패킷을 까보면, 공유기가 특정 포트로 들어온 요청을 다른 특정 IP의 특정 포트로 전송을 진행해준다.

- 포트포워딩 설정을 일반적으로 공유기에서 진행한다.  