# [운영체제] - 스레드

프로세스를 구성하는 실행의 흐름 단위 : 스레드

멀티스레드 vs 멀티 프로세스

<hr>

<br>

스레드란 프로세스를 구성하는 실행의 흐름 단위이다. 하나의 프로세스는 여러 개의 스레드를 가질 수 있고, 스레드를 이용하면 하나의 프로세스에서 여러 부분을 동시에 실행할 수 있다. 

<br>

### - 프로세스와 스레드

전통적인 관점에서 하나의 프로세스는 한 번에 하나의 일만을 처리 했다. '실행의 흐름 단위가 하나' 라는 점에서 이렇게 실행되는 프로세스들은 `단일 스레드 프로세스`라고 한다.

하지만 `스레드`라는 개념이 도입되면서 하나의 프로세스가 한 번에 여러 일을 동시에 처리할 수 있게 되었다. 즉, 프로세스를 구성하는 여러 명령어를 동시에 실행할 수 있게 된 것이다. 스레드는 프로세스 내에서 각기 다른 스레드 ID, 프로그램 카운터 값을 비롯한 레지스터 값, 스택으로 구성된다. 따라서 스레드마다 각기 다른 코드를 실행할 수 있다. 

![image-20221203221739115](%5B%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%5D%20-%20%EC%8A%A4%EB%A0%88%EB%93%9C.assets/image-20221203221739115.png)

프로세스의 스레드들은 실행에 필요한 최소한의 정보(프로그램 카운터를 포함한 레지스터, 스택)만을 유지한 채 프로세스의 자원(코드, 데이터, 힙 영역)을 공유하며 실행된다. 프로세스의 자원을 공유한다는 것이 스레드의 핵심!

스레드는 프로세스를 구성하는 실행의 흐름 단위, 최근 많은 운영체제는 CPU에 처리할 작업을 전달할 때 프로세스가 아닌 스레드 단위로 전달한다. 그리고 스레드는 프로세스 자원을 공유한 채 실행에 필요한 최소한의 정보만으로 실행된다.

<br>

### - 멀티프로세스와 멀티스레드

컴퓨터 실행 과정에서 여러 프로세스가 동시에 실행될 수 있고, 그 프로세스를 이루는 스레드는 여러 개가 있을 수 있다. 

멀티프로세스 : 여러 프로세스를 동시에 실행하는 것

멀티스레드 : 여러 스레드로 프로세스를 동시에 실행하는 것

이 2가지는 큰 차이를 가진다. 프로세스끼리는 기본적으로 자원을 공유하지 않지만, 스레드끼리는 같은 프로세스 내의 자원을 공유한다.

프로세스를 fork 하여 같은 작업을 하는 동일한 프로세스 2개를 동시에 실행하면 모든 자원(코드, 데이터, 힙 영역 등)이 복제되어 메모리에 적재된다. 한 마디로 PID, 저장된 메모리 주소를 제외하면 모든 것이 동일한 프로세스 2개가 통째로 메모리에 적재되는 것이기 때문에 낭비일 수 있다. 같은 프로그램을 실행하기 위해 메모리에 동일한 내용들이 중복해서 존재하기 때문에!

![image-20221203223309058](%5B%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%5D%20-%20%EC%8A%A4%EB%A0%88%EB%93%9C.assets/image-20221203223309058.png)

반면, 스레드들은 각기 다른 스레드 ID, 프로그램 카운터 값을 포함한 레지스터 값, 스택을 가질 뿐 프로세스가 가지고 있는 자원을 공유한다. 따라서 여러 프로세스를 병행 실행하는 것보다 메모리를 더 효율적으로 사용할 수 있다. 또한 자원을 공유하기 때문에 서로 협력과 통신에 유리하다. 

프로세스의 자원을 공유한다는 특성은 단점이 될 수도 있다. 멀티스레드 환경에서 하나의 스레드에 문제가 생기면 프로세스 전체에 문제가 생길 수 있다. 자원 공유의 이유로 하나의 스레드의 문제가 생기면 다른 스레드도 영향을 받기 때문이다. 반면 멀티프로세스 환경에서는 서로가 남남이기 때문에 하나의 프로세스에 문제가 생겨도 다른 프로세스에는 지장이 적거나 없다.

[-> 스레드 실습](https://github.com/kangtegong/self-learning-cs/blob/main/thread/thread_python.md#python%EC%9C%BC%EB%A1%9C-%EC%8A%A4%EB%A0%88%EB%93%9C-%EB%8B%A4%EB%A3%A8%EA%B8%B0)