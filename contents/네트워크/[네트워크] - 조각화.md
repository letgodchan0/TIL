# [네트워크] - 조각화



![image-20230125234632365](%5B%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%5D%20-%20%EC%A1%B0%EA%B0%81%ED%99%94.assets/image-20230125234632365.png)

<BR>

큰 IP 패킷들이 적은 MTU(최대 전송 단위)를 갖는 링크를 통하여 전송되려면 <u>**여러 개의 작은 패킷으로 쪼개어/조각화**</u> 되어 전송 되어야 한다.

즉, 목적지까지 패킷을 전달하는 과정에 통과하는 각 라우터마다 전송에 적합한 프레임으로 변환이 필요하다.

일단 조각화되면, 최종 목적지에 도달할 때까지 재조립되지 않는 것이 일반적이다.

- IPv4에서는 발신지 뿐만 아니라 중간 라우터에서도 IP 조각화 가능!

- IPv6에서는 IP 단편화가 발신지에서만 가능!

- 재조립은 항상 최종 수신지에서만 가능함!

<BR>

 ### - IPv4의 조각화

![image-20230125235013417](%5B%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%5D%20-%20%EC%A1%B0%EA%B0%81%ED%99%94.assets/image-20230125235013417.png)

- 2,000byte 만큼의 데이터를 요청하고, MTU가 1,500일때
- IPv4의 20바이트를 제외하고 1480으로 데이터를 조각화한다.
- ICMP 패킷은 항상 제일 마지막 패킷에 붙는다.
- 그리고 14바이트의 이더넷을 붙힘

<BR>

#### 문제

보내려는 데이터 크기 : 2379

MTU : 980

- 몇 개의 패킷으로 쪼개지는가?
  - IPv4 프로토콜이 붙어야 하니까, MTU에서 20을 뺀 960 크기 만큼 최대 한번에 보낼 수 있다.
  - 2379를 960으로 나누면 총 3개의 패킷으로 쪼개진다.
  - 960, 960, 459
- 첫번째 패킷의 데이터의 크기는 몇인가?
  - 위 3개 숫자에 각각 20의 IPv4 프로토콜을 붙이면, 첫번째는 980
- 마지막 패킷의 데이터의 크기는 몇인가?
  - 마지막은 459 + 20인 479이다. 