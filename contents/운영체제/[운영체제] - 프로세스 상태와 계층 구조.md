# [운영체제] - 프로세스 상태와 계층 구조

프로세스는 각자의 상태를 가지고 계층적인 구조를 이루고 있다. 프로세스 상태와 계층 구조가 무엇인지 알아보자잇!

<hr>

<br>

### - 프로세스 상태

컴퓨터를 사용할 때 여러 프로세스들이 빠르게 번갈아 가면서 실행이 된다. 이 과정에서 하나의 프로세스는 여러 상태를 거치며 실행된다. 그리고 운영체제는 프로세스의 상태를 PCB를 통해 인식하고 관리한다. 

운영체제마다 상태를 관리하는 방식은 차이가 있지만, 대표적인 상태는 아래와 같다.

<hr>

#### 1. 생성 상태

프로세스를 생성 중인 상태를 말하며, 이제 막 메모리에 적재되어 PCB를 할당 받은 상태를 뜻한다. 생성 상태를 거치면 프로세스가 바로 실행되는 것이 아니라 준비 상태가 되면서 CPU 할당을 기다리게 된다.

#### 2. 준비 상태

언제든지 CPU를 할당 받아 실행할 수 있는 상태, BUT 아직은 내 차례가 아니라서 기다리고 있는 상태

```text
준비 상태인 프로세스가 실행 상태로 전환되는 것을 디스패치라고 한다!
```

#### 3. 실행 상태

준비 상태인 프로세스가 CPU를 할당 받아 실행 중인 상태를 뜻한다. 이 때 프로세스는 할당된 일정 시간 동안만 CPU를 사용할 수 있다. 타이머 인터럽트(할당된 시간 모두 사용)가 발생하면, 다시 준비 상태가 된다.

실행 도중 입출력 장치를 사용하여 입출력 장치의 작업이 끝날 때까지 기다려야 한다면 대기 상태가 된다.

#### 4. 대기 상태

프로세스를 실행하면서 입출력 장치를 사용하는 경우가 있다. 입출력 작업은 CPU에 비해 처리 속도가 느리기 때문에, `입출력 완료 인터럽트`(입출력을 끝낼 때 까지)를 기다려야 한다. 이렇게 입출력 작업을 기다리는 상태를 대기 상태라고 한다.

입출력 작업이 끝나면, 프로세스는 다시 준비 상태로 CPU 할당을 기다린다. 

#### 5. 종료 상태

프로세스가 종료된 상태로, 운영체제는 프로세스가 종료되면 PCB와 프로세스가 사용한 메모리를 정리한다. 

<hr>



![99F987335A5360A209](%5B%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%5D%20-%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%20%EC%83%81%ED%83%9C%EC%99%80%20%EA%B3%84%EC%B8%B5%20%EA%B5%AC%EC%A1%B0.assets/99F987335A5360A209.png)

위와 같이 여러 프로세스는 생성, 준비, 대기, 실행, 종료 상태를 거치며 실행되고 운영체제는 이 상태를 PCB에 기록하며 프로세스를 관리한다.

<br>

### - 프로세스 계층 구조

![image-20221202230539838](%5B%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%5D%20-%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%20%EC%83%81%ED%83%9C%EC%99%80%20%EA%B3%84%EC%B8%B5%20%EA%B5%AC%EC%A1%B0.assets/image-20221202230539838.png)

프로세스는 실행 중 시스템 호출을 통해 다른 프로세스를 생성할 수 있다. 

부모 프로세스 : 새 프로세스를 생성한 프로세스

자식 프로세스 : 부모 프로세스에 의해 생성된 프로세스

부모 프로세스와 자식 프로세스는 다른 프로세스이기 때문에 각기 다른 PID를 가진다. 일부 운영 체제에서는 자식 프로세스의 PCB에 부모 프로세스의 PID인 `PPID(Parent PID)`가 기록되기도 한다. 

프로세스는 계속해서 자식 프로세스를 생성할 수 있기 때문에, 많은 운영체제는 계층적인 구조로써 프로세스들을 관리한다. 컴퓨터가 부팅될 때 실행되는 최초의 프로세스가 자식 프로세스들을 생성하고, 생성된 자식 프로세스들이 새로운 프로세스들을 낳는 형식으로 여러 프로세스가 동시에 실행된다.

<BR>

### - 프로세스 생성 기법

부모 프로세스는 `fork`를 통해 자신의 복사본을 자식 프로세스로 생성하고 만들어진 복사본(자식 프로세스)은 `exec`를 통해 자신의 메모리 공간을 다른 프로그램으로 교체한다. 자식 프로세스는 부모의 복사본이기 때문에 부모가 사용한 자원(메모리의 내용, 열린 파일 목록 등)이 자식에게 상속된다.

fork : 자기 자신 프로세스의 복사본을 만드는 시스템 호출

exec : 자신의 메모리 공간을 새로운 프로그램으로 덮어쓰는 시스템 호출

<br>

[-> Python으로 프로세스 다루기](https://github.com/kangtegong/self-learning-cs/blob/main/process/process_python.md#python%EC%9C%BC%EB%A1%9C-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8B%A4%EB%A3%A8%EA%B8%B0)















